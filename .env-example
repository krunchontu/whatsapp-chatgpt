# ============================================== #
#        WhatsApp AI Customer Service Bot        #
#              MVP Configuration                 #
# ============================================== #
# Make a copy of this file and rename it to .env
# Documentation: /docs/MVP_PLAN.md

# ============================================== #
#              Environment                       #
# ============================================== #
NODE_ENV=development

# ============================================== #
#           Database & Cache                     #
# ============================================== #
# SQLite for MVP (file-based, zero cost)
# For local dev: file:./data/whatsapp-bot.db
# For Docker: file:/data/whatsapp-bot.db
DATABASE_URL=file:./data/whatsapp-bot.db

# Redis (for rate limiting and job queue)
# Local: redis://localhost:6379
# Docker: redis://redis:6379
REDIS_URL=redis://localhost:6379
REDIS_ENABLED=true

# Alternative Redis configuration (if not using URL)
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=
# REDIS_DB=0

# ============================================== #
#              OpenAI Configuration              #
# ============================================== #
# Get your key here: https://platform.openai.com/account/api-keys
OPENAI_API_KEY=

# OpenAI Organization ID (optional)
OPENAI_ORGANIZATION=
OPENAI_PROJECT=

# OpenAI Client Configuration
# Timeout in milliseconds (30 seconds recommended for MVP)
OPENAI_TIMEOUT=30000

# Maximum number of retries for OpenAI API requests
OPENAI_MAX_RETRIES=3

# Multiple API keys for rate limit rotation (optional)
# OPENAI_API_KEYS=sk-xxx,sk-yyy,sk-zzz

# ============================================== #
#              AI Models & Behavior              #
# ============================================== #
# GPT Model (gpt-4o recommended for customer service)
OPENAI_GPT_MODEL=gpt-4o

# Vision model for image analysis
VISION_MODEL=gpt-4o
VISION_ENABLED=true

# Max tokens per request (cost control)
MAX_MODEL_TOKENS=2000

# System prompt (defines bot personality and role)
# Example for customer service:
PRE_PROMPT=You are a professional customer service assistant. Be helpful, concise, and friendly. Keep responses under 3 sentences when possible. If you don't know the answer, admit it and offer to escalate to a human agent.

# ============================================== #
#          Rate Limiting & Cost Control          #
# ============================================== #
# Enable rate limiting (recommended for production)
RATE_LIMIT_ENABLED=true

# Per-user rate limit (messages per minute)
RATE_LIMIT_PER_USER=10
RATE_LIMIT_PER_USER_WINDOW=60

# Global rate limit (total messages per minute)
RATE_LIMIT_GLOBAL=100
RATE_LIMIT_GLOBAL_WINDOW=60

# Daily cost alert threshold (in USD)
COST_ALERT_THRESHOLD=50

# Alert email (optional, for cost alerts)
ALERT_EMAIL=

# ============================================== #
#            Access Control (RBAC)               #
# ============================================== #
# Admin phone numbers (can use !usage, !config, !stats commands)
# Format: +1234567890,+0987654321 (comma-separated, with country code)
ADMIN_PHONE_NUMBERS=

# Whitelisted phone numbers (users who can chat with bot)
# Leave empty to allow all numbers
WHITELISTED_PHONE_NUMBERS=

# Enable whitelist mode (if true, only whitelisted numbers can use bot)
WHITELISTED_ENABLED=false

# ============================================== #
#            Bot Behavior Settings               #
# ============================================== #
# Whether to require command prefixes (!gpt, !dalle)
# Set to false for customer service (more natural)
PREFIX_ENABLED=false

# Skip prefix for self-notes (messages to yourself)
PREFIX_SKIPPED_FOR_ME=true

# Custom prefixes (if PREFIX_ENABLED=true)
GPT_PREFIX=!gpt
DALLE_PREFIX=!dalle
RESET_PREFIX=!reset
AI_CONFIG_PREFIX=!config

# Allow bot in group chats (disable for MVP - 1:1 only)
GROUPCHATS_ENABLED=false

# Content moderation (prevent spam/abuse)
MODERATION_ENABLED=true
CUSTOM_MODERATION_PARAMS={"harassment":true,"harassment/threatening":true,"hate":true,"self-harm":false,"sexual":false,"violence":false}
# ============================================== #
#          Voice Transcription (MVP)             #
# ============================================== #
# Enable voice message transcription
TRANSCRIPTION_ENABLED=true

# Transcription mode (MVP: use "openai" only)
# "openai" = OpenAI Whisper API (recommended for MVP)
# "local" = Local Whisper (requires installation, not recommended)
# "speech-api" = Speech API (requires separate service)
# "whisper-api" = Whisper API (requires separate service)
TRANSCRIPTION_MODE=openai

# Transcription language (auto-detect if empty)
TRANSCRIPTION_LANGUAGE=

# ============================================== #
#        Text-to-Speech (DISABLED FOR MVP)       #
# ============================================== #
# Disable TTS for MVP (adds complexity and cost)
TTS_ENABLED=false

# ============================================== #
#            Monitoring & Logging                #
# ============================================== #
# Log level: debug, info, warn, error
LOG_LEVEL=info

# Sentry DSN for error tracking (optional, free tier available)
# Sign up at https://sentry.io
SENTRY_DSN=

# Better Stack / Logtail token (optional, free tier available)
# Sign up at https://betterstack.com
LOGTAIL_SOURCE_TOKEN=

# ============================================== #
#         Advanced (Optional)                    #
# ============================================== #
# WhatsApp session path (where QR code data is stored)
SESSION_PATH=./session

# Conversation retention (days before auto-delete)
CONVERSATION_RETENTION_DAYS=7

# Max message length (characters)
MAX_MESSAGE_LENGTH=4000
